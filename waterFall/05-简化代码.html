<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>05-简化代码</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			font-family: "Microsoft Yahei";
		}

		.box {
			position: relative;
			width: 1200px;
			margin: 0 auto;
		}

		.item {
			width: 232px;
			position: absolute;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
			overflow: hidden;
		}

		.item>img {
			width: 100%;
			display: block;
		}

		.item>p {
			margin: 0;
			padding: 10px;
			background: #eee;
		}

		.btn {
			width: 280px;
			height: 40px;
			margin: 30px auto;
			text-align: center;
			line-height: 40px;
			background-color: #CCC;
			border-radius: 6px;
			font-size: 24px;
			cursor: pointer;
		}

		.loading {
			background-color: transparent;
		}
	</style>
</head>

<body>
	<div class="box">
		<div class="item ">
			<img src="./images/1.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/2.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/3.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/4.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/3.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/4.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/3.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/4.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/3.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/4.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/3.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/4.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/6.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/6.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/6.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/5.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/6.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/7.jpg" alt="">
			<p>花非花云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/8.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
		<div class="item">
			<img src="./images/9.jpg" alt="">
			<p>花非花，雾非雾，夜半来，天明去，来如春梦不多时，去似朝云无觅处。花非花，雾非雾，夜半来，天明去，，夜半来，天明去，，夜半来，天明去，来如春梦不多时，去似朝云无觅处。</p>
		</div>
	</div>

	<div class="btn">加载更多</div>

	<script src="js/jquery-1.12.4.js"></script>
	<script>
		// 1.获取父盒子 .box
		var $box = $('.box');
		// 2.根据父盒子,获取所有子盒子 item
		var $items = $box.children();
		// 3.获取每一子盒子的高度, 宽度
		var itemWidth = $items.width();
		// 4. 计算每一个item之间的间隔
		var gap = ($box.width() - 5 * itemWidth) / 4;

		//声明一个数组,用于存储每一列的高度
		var arr = [0, 0, 0, 0, 0];
		//5. 遍历$items,判断是否是前5个,如果是前5个就设置left和top,进行布局
		$items.each(function (index, item) {
			//给前5个item布局
			// if(index < 5){
			// 	//证明是第一行的item
			// 	// console.log(item);
			// 	//item是dom对象,通过$()方法可以包装秤jquery对象,就可以使用jquery的方法
			// 	//设置left 和 top
			// 	$(item).css({
			// 			//  index * (宽度 + 间隔)
			// 		 left: index * (itemWidth + gap),
			// 		 top:	0
			// 	});

			// 	//把每一列的高度,存储到数组中, 第一行的时候,每一列的高度就是item的高度
			// 	arr[index] = $(item).height();

			// }else{
			//6.其他行

			// 6.1找到数组中最小高度的那一列,以及对应的下标
			var min = arr[0];
			var minIndex = 0;
			arr.forEach(function (itemheight, i) {
				if (min > itemheight) {
					min = itemheight;
					minIndex = i;
				}

			});

			// 6.2根据最小高度的那一列的值,给新的item设置位置
			$(item).css({
				top: min + gap,
				left: minIndex * (itemWidth + gap)
			})

			// 6.3给刚才的最小高度重新设置值
			arr[minIndex] += gap + $(item).height();

		})

		// 7.给父盒子设置高度
		// 找到数组中,最高的那一列的高度, 把这个高度,设置给父盒子
		//  7.1 找到arr中的最大值
		var max = Math.max.apply(null, arr);
		//  7.2 把最大值赋值给父盒子
		$box.height(max);
	</script>
</body>


</html>